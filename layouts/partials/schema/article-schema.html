<script type="application/ld+json">
{{/* ✅ 平台 → 内容类型映射表 */}}
{{ $platformTypes := dict
  "YouTube" "video-guide"
  "TikTok" "shortform-strategy"
  "Instagram" "visual-marketing-guide"
  "Facebook" "ads-optimization-handbook"
  "Telegram" "community-engagement"
  "Twitter" "microblog-playbook"
  "LinkedIn" "b2b-outreach-guide"
  "Snapchat" "youth-marketing"
  "Reddit" "discussion-growth"
  "Pinterest" "visual-discovery-guide"
}}

{{/* ✅ 内容类型翻译表 */}}
{{ $translatedTypes := dict
  "video-guide" (dict "en" "Video Guide" "lv" "Video ceļvedis" "zh" "视频指南")
  "shortform-strategy" (dict "en" "Shortform Strategy" "lv" "Īso video stratēģija" "zh" "短视频策略")
  "visual-marketing-guide" (dict "en" "Visual Marketing Guide" "lv" "Vizuālā mārketinga ceļvedis" "zh" "视觉营销指南")
  "ads-optimization-handbook" (dict "en" "Ads Optimization Handbook" "lv" "Reklāmu optimizācijas rokasgrāmata" "zh" "广告优化手册")
  "community-engagement" (dict "en" "Community Engagement" "lv" "Kopienas iesaiste" "zh" "社区互动指南")
  "microblog-playbook" (dict "en" "Microblog Playbook" "lv" "Mikrobloga rokasgrāmata" "zh" "微博营销指南")
  "b2b-outreach-guide" (dict "en" "B2B Outreach Guide" "lv" "B2B sasniedzamības ceļvedis" "zh" "B2B拓展指南")
  "youth-marketing" (dict "en" "Youth Marketing" "lv" "Jauniešu mārketings" "zh" "年轻人营销")
  "discussion-growth" (dict "en" "Forum Growth Guide" "lv" "Diskusiju izaugsme" "zh" "社区增长指南")
  "visual-discovery-guide" (dict "en" "Visual Discovery Guide" "lv" "Vizuālās izpētes ceļvedis" "zh" "视觉探索指南")
  "social-media-marketing" (dict "en" "Social Media Marketing" "lv" "Sociālo mediju mārketings" "zh" "社交媒体营销")
}}

{{/* ✅ 主平台与类型识别 */}}
{{ $mainPlatform := index (.Params.platforms | default (slice "YouTube")) 0 }}
{{ $baseType := index $platformTypes $mainPlatform }}
{{ if not $baseType }}{{ $baseType = "social-media-marketing" }}{{ end }}

{{/* ✅ 多语言内容类型 */}}
{{ $lang := .Params.language | default "lv" }}
{{ $contentTypeMap := index $translatedTypes $baseType }}
{{ $contentType := "" }}
{{ if $contentTypeMap }}
  {{ $contentType = index $contentTypeMap $lang }}
  {{ if not $contentType }}
    {{ $contentType = index $contentTypeMap "en" }}
  {{ end }}
{{ end }}
{{ if not $contentType }}{{ $contentType = "Social Media Marketing" }}{{ end }}

{{/* ✅ 图片处理 */}}
{{ $image := .Params.featuredImage | default "https://baoliba.com/logo.png" }}

{{/* ✅ 作者字段防空处理 */}}
{{ $author := .Params.author | plainify | trim " " }}
{{ if not $author }}{{ $author = "BaoLiba" }}{{ end }}

{{/* ✅ keywords 安全处理 */}}
{{ $keywords := delimit (apply (.Params.keywords | default (slice)) "plainify" ".") ", " }}

{
  "@context": "https://schema.org",
  "@type": "Article",

  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ .Permalink | printf "%q" }}
  },

  "headline": {{ .Title | default "Untitled" | plainify | trim " " | jsonify }},
  "description": {{ .Params.description | default (.Summary | plainify) | trim " " | jsonify }},
  "articleBody": {{ .Content | plainify | trim " " | jsonify }},
  "keywords": {{ $keywords | jsonify }},
  "articleSection": {{ .Params.categories | default "" | plainify | trim " " | jsonify }},

  "datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
  "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",

  "author": {
    "@type": "Organization",
    "name": {{ $author | jsonify }}
  },

  "publisher": {
    "@type": "Organization",
    "name": "BaoLiba",
    "logo": {
      "@type": "ImageObject",
      "url": {{ "https://baoliba.com/logo.png" | printf "%q" }}
    }
  },

  "image": {
    "@type": "ImageObject",
    "url": {{ $image | printf "%q" }}
  },

  "inLanguage": {{ $lang | plainify | trim " " | jsonify }},
  "countryOfOrigin": {{ .Params.country | default "Latvia" | plainify | trim " " | jsonify }},
  "about": {{ delimit (.Params.platforms | default (slice "YouTube")) ", " | plainify | trim " " | jsonify }},
  "name": {{ $contentType | plainify | trim " " | jsonify }}
}
</script>

